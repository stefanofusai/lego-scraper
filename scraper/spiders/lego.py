from scrapy.http import JsonRequest

from scraper.items import Item
from scraper.spiders.base import BaseSpider


class SubitoSpider(BaseSpider):
    name = "lego"

    allowed_domains = ["lego.com"]
    start_urls = [
        "https://www.lego.com/it-it/product/ahsoka-tano-40539",
        "https://www.lego.com/it-it/product/tusken-raider-40615",
        "https://www.lego.com/it-it/product/battle-of-endor-heroes-40623",
        "https://www.lego.com/it-it/product/alex-40624",
        "https://www.lego.com/it-it/product/llama-40625",
        "https://www.lego.com/it-it/product/zombie-40626",
        "https://www.lego.com/it-it/product/imperial-tie-fighter-75300",
        "https://www.lego.com/it-it/product/luke-skywalker-s-x-wing-fighter-75301",
        "https://www.lego.com/it-it/product/darth-vader-helmet-75304",
        "https://www.lego.com/it-it/product/boba-fett-s-starship-75312",
        "https://www.lego.com/it-it/product/snowtrooper-battle-pack-75320",
        "https://www.lego.com/it-it/product/mos-eisley-cantina-75290",
        "https://www.lego.com/it-it/product/obi-wan-kenobi-s-jedi-starfighter-75333",
        "https://www.lego.com/it-it/product/501st-clone-troopers-battle-pack-75345",
        "https://www.lego.com/it-it/product/tie-bomber-75347",
        "https://www.lego.com/it-it/product/mandalorian-fang-fighter-vs-tie-interceptor-75348",
        "https://www.lego.com/it-it/product/clone-commander-cody-helmet-75350",
        "https://www.lego.com/it-it/product/princess-leia-boushh-helmet-75351",
        "https://www.lego.com/it-it/product/emperor-s-throne-room-diorama-75352",
        "https://www.lego.com/it-it/product/endor-speeder-chase-diorama-75353",
        "https://www.lego.com/it-it/product/coruscant-guard-gunship-75354",
        "https://www.lego.com/it-it/product/executor-super-star-destroyer-75356",
        "https://www.lego.com/it-it/product/tdb-lsw-2023-16-75359",
        "https://www.lego.com/it-it/product/yoda-s-jedi-starfighter-75360",
        "https://www.lego.com/it-it/product/spider-tank-75361",
        "https://www.lego.com/it-it/product/new-republic-e-wing-vs-shin-hati-s-starfighter-75364",
        "https://www.lego.com/it-it/product/boba-fett-mech-75369",
    ]

    def start_requests(self):
        for url in self.start_urls:
            yield JsonRequest(
                "https://www.lego.com/api/graphql/ProductDetails",
                data={
                    "operationName": "ProductDetails",
                    "variables": {"slug": url.split("/")[-1]},
                    "query": "query ProductDetails($slug: String!, $visibility: ProductVisibility) {\n  product(slug: $slug, visibility: $visibility) {\n    ...ProductDetails_Product\n    ...ProductFeatures_Product\n    ...ProductUgc_Product\n    ...ProductOverview_Product\n    ...ProductMediaViewer_Media\n    ...Product_ProductItem\n    contentBody {\n      ...ContentContainerData\n      __typename\n    }\n    colorVariantProducts {\n      ... on ColorVariantProduct {\n        id\n        productCode\n        name\n        slug\n        primaryImage(size: THUMBNAIL)\n        overrideUrl\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment Product_ProductItem on Product {\n  __typename\n  id\n  productCode\n  name\n  slug\n  primaryImage(size: THUMBNAIL)\n  baseImgUrl: primaryImage\n  additionalImages {\n    url\n    tag\n    __typename\n  }\n  listingImages: listingAssets(type: IMAGE, limit: 2) {\n    ... on ListingProductAsset {\n      id\n      tag\n      url\n      thumbnailDimensions {\n        height\n        width\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  overrideUrl\n  ... on ReadOnlyProduct {\n    readOnlyVariant {\n      ...Variant_ReadOnlyProduct\n      __typename\n    }\n    __typename\n  }\n  ... on SingleVariantProduct {\n    variant {\n      ...Variant_ListingProduct\n      __typename\n    }\n    __typename\n  }\n  ... on MultiVariantProduct {\n    priceRange {\n      formattedPriceRange\n      formattedListPriceRange\n      __typename\n    }\n    variants {\n      ...Variant_ListingProduct\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment Variant_ListingProduct on ProductVariant {\n  id\n  sku\n  salePercentage\n  attributes {\n    rating\n    maxOrderQuantity\n    availabilityStatus\n    availabilityText\n    vipAvailabilityStatus\n    vipAvailabilityText\n    canAddToBag\n    canAddToWishlist\n    vipCanAddToBag\n    onSale\n    isNew\n    ageRange\n    pieceCount\n    safetyWarning {\n      safetyWarningKey: key\n      safetyWarningLabel: label\n      showSafetyImage\n      imageKey\n      __typename\n    }\n    ...ProductAttributes_Flags\n    __typename\n  }\n  ...ProductVariant_Pricing\n  __typename\n}\n\nfragment ProductVariant_Pricing on ProductVariant {\n  price {\n    formattedAmount\n    centAmount\n    currencyCode\n    formattedValue\n    __typename\n  }\n  listPrice {\n    formattedAmount\n    centAmount\n    __typename\n  }\n  attributes {\n    onSale\n    __typename\n  }\n  __typename\n}\n\nfragment ProductAttributes_Flags on ProductAttributes {\n  featuredFlags {\n    key\n    label\n    __typename\n  }\n  __typename\n}\n\nfragment Variant_ReadOnlyProduct on ReadOnlyVariant {\n  id\n  sku\n  attributes {\n    featuredFlags {\n      key\n      label\n      __typename\n    }\n    ageRange\n    pieceCount\n    __typename\n  }\n  __typename\n}\n\nfragment ContentContainerData on ContentContainer {\n  ...BaseContentContainer\n  section {\n    ...BaseContentSection\n    __typename\n  }\n  __typename\n}\n\nfragment BaseContentContainer on ContentContainer {\n  id\n  multivariate {\n    experimentId\n    entityId\n    testingId\n    inExperimentAudience\n    __typename\n  }\n  targeting {\n    fetchOnClient\n    __typename\n  }\n  __typename\n}\n\nfragment BaseContentSection on ContentSection {\n  __typename\n  id\n  layout {\n    width\n    colors {\n      background\n      __typename\n    }\n    __typename\n  }\n  ...CarouselContentSection\n  ...CustomCarouselContentSection\n  ...UserGeneratedContentData\n  ...AccordionSectionData\n  ...BreadcrumbSection\n  ...CategoryListingSection\n  ...ListingBannerSection\n  ...CardContentSection\n  ...CardCarouselSection\n  ...CopyContent\n  ...CopySectionData\n  ...QuickLinksData\n  ...ContentBlockMixedData\n  ...HeroBannerData\n  ...MotionBannerData\n  ...MotionSidekickData\n  ...InPageNavData\n  ...GalleryData\n  ...TableData\n  ...CountdownBannerData\n  ...RecommendationSectionData\n  ...SidekickBannerData\n  ...TextBlockData\n  ...TextBlockSEOData\n  ...CrowdTwistWidgetSection\n  ...CrowdTwistToggleWidgetSection\n  ...CrowdTwistCodeRedemptionBanner\n  ...CodedSection\n  ...GridSectionData\n  ...StickyCTAData\n  ...AudioSectionData\n  ...MotionSidekick1x1Data\n  ...ImageTransitionSliderData\n  ...ImageXrayViewerData\n  ...PollsSectionData\n  ...ArtNavigationData\n  ...MotionBanner16x9Data\n  ...QuickLinksAdvancedData\n  ...ArticleSectionData\n  ...RelatedArticleSectionData\n  ...FeatureExplorerSectionData\n  ...IdeaGeneratorSectionData\n  ...TabbedContentExplorerData\n  ...CustomProductCarousel_UniqueFields\n  ...CustomProductCarousel_ItemFields\n  ...CardContentRTWData\n  ...ExpandedCardContentData\n  ...ArticleTextData\n  ...ArticleImageSectionData\n  ...ExpandedProductLeafData\n  ...Dots3DSectionData\n  ...NinetiethAnniversaryExperienceData\n  ...ArticleGroupSectionData\n  ...MotionBannerSectionData\n  ...AdvancedProductHeroBannerSectionData\n  ...PlayTypeDetectorSectionData\n  ...SocialShareSectionData\n  ...EcosystemJourneyStarterData\n  ...ResultsBannerSectionData\n  ...CharacterExplorerSectionData\n  ...SubmissionFormBannerSectionData\n  ...RebuildTheWorld2023Data\n  ...PromotionSectionData\n}\n\nfragment CarouselContentSection on ContentSection {\n  ... on ProductCarouselSection {\n    ...ProductCarousel_UniqueFields\n    productCarouselProducts: products(\n      page: 1\n      perPage: 16\n      sort: {key: FEATURED, direction: DESC}\n    ) {\n      ...Product_ProductItem\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment CustomCarouselContentSection on ContentSection {\n  ... on CustomProductCarouselSection {\n    ...CustomProductCarousel_UniqueFields\n    productCarouselProducts: products(\n      page: 1\n      perPage: 16\n      sort: {key: FEATURED, direction: DESC}\n    ) {\n      ...CustomProductCarousel_ItemFields\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment AccordionSectionData on AccordionSection {\n  __typename\n  id\n  title\n  showTitle\n  schema\n  accordionBlocks {\n    title\n    text\n    __typename\n  }\n}\n\nfragment BreadcrumbSection on BreadcrumbSection {\n  ...BreadcrumbDynamicSection\n  __typename\n}\n\nfragment BreadcrumbDynamicSection on BreadcrumbSection {\n  breadcrumbs {\n    label\n    url\n    analyticsTitle\n    __typename\n  }\n  __typename\n}\n\nfragment ListingBannerSection on ListingBannerSection {\n  ...ListingBanner\n  __typename\n}\n\nfragment ListingBanner on ListingBannerSection {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  title\n  description\n  contrast\n  logoImage\n  backgroundImages {\n    small {\n      ...ImageAsset\n      __typename\n    }\n    medium {\n      ...ImageAsset\n      __typename\n    }\n    large {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment ImageAsset on ImageAssetDetails {\n  url\n  width\n  height\n  maxPixelDensity\n  format\n  __typename\n}\n\nfragment CategoryListingSection on CategoryListingSection {\n  ...CategoryListing\n  __typename\n}\n\nfragment CategoryListing on CategoryListingSection {\n  title\n  description\n  thumbnailImage\n  children {\n    ...CategoryLeafSection\n    __typename\n  }\n  hasCustomContent\n  __typename\n}\n\nfragment CategoryLeafSection on CategoryListingChildren {\n  title\n  description\n  thumbnailImage\n  logoImage\n  url\n  ageRange\n  tag\n  thumbnailSrc {\n    ...ImageAsset\n    __typename\n  }\n  doesNotHaveAnAboutPage\n  __typename\n}\n\nfragment CardContentSection on CardContentSection {\n  ...CardContent\n  __typename\n}\n\nfragment CardContent on CardContentSection {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  moduleTitle\n  showModuleTitle\n  backgroundColor\n  blocks {\n    title\n    isH1\n    description\n    textAlignment\n    primaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    logoPosition\n    imageSrc {\n      ...ImageAsset\n      __typename\n    }\n    callToActionText\n    callToActionLink\n    callToActionUseAnalytics\n    callToActionOpenInNewTab\n    accountActionValue\n    accountActionReturnUrl\n    altText\n    contrast\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment VideoAssetFragment on VideoMedia {\n  url\n  id\n  isLiveStream\n  subtitlesUrl\n  __typename\n}\n\nfragment CardCarouselSection on CardCarouselSection {\n  ...CardCarouselContent\n  __typename\n}\n\nfragment CardCarouselContent on CardCarouselSection {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  moduleTitle\n  showModuleTitle\n  backgroundColor\n  blocks {\n    title\n    isH1\n    description\n    textAlignment\n    primaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    logoPosition\n    imageSrc {\n      ...ImageAsset\n      __typename\n    }\n    callToActionText\n    callToActionLink\n    callToActionUseAnalytics\n    callToActionOpenInNewTab\n    altText\n    contrast\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment CopyContent on CopyContentSection {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  blocks {\n    title\n    body\n    textAlignment\n    titleColor\n    imageSrc {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment CopySectionData on CopySection {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  title\n  showTitle\n  body\n  __typename\n}\n\nfragment QuickLinksData on QuickLinkSection {\n  title\n  layout {\n    colors {\n      background\n      __typename\n    }\n    __typename\n  }\n  quickLinks {\n    title\n    isH1\n    link\n    openInNewTab\n    contrast\n    altText\n    imageSrcUrl\n    __typename\n  }\n  __typename\n}\n\nfragment ContentBlockMixedData on ContentBlockMixed {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  moduleTitle\n  showModuleTitle\n  blocks {\n    title\n    isH1\n    description\n    backgroundColor\n    blockTheme\n    contentPosition\n    logoURL\n    secondaryLogoURL\n    logoPosition\n    callToActionText\n    callToActionLink\n    altText\n    backgroundImages {\n      largeImage {\n        small {\n          ...ImageAsset\n          __typename\n        }\n        large {\n          ...ImageAsset\n          __typename\n        }\n        __typename\n      }\n      smallImage {\n        small {\n          ...ImageAsset\n          __typename\n        }\n        large {\n          ...ImageAsset\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment UserGeneratedContentData on UserGeneratedContent {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  ugcBlock {\n    title\n    text\n    ugcType\n    ugcKey\n    __typename\n  }\n  __typename\n}\n\nfragment HeroBannerData on HeroBanner {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  heroblocks {\n    id\n    title\n    isH1\n    tagline\n    bannerTheme\n    contentVerticalPosition\n    contentHorizontalPosition\n    contentHeight\n    primaryLogoSrcNew {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrcNew {\n      ...ImageAsset\n      __typename\n    }\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    logoPosition\n    contentBackground\n    callToActionText\n    callToActionLink\n    callToActionOpenInNewTab\n    brandedAppStoreAsset {\n      ...ImageAsset\n      __typename\n    }\n    callToActionAccountAction\n    callToActionReturnUrl\n    callToActionUseAnalytics\n    secondaryCallToActionText\n    secondaryCallToActionLink\n    secondaryCallToActionAccountAction\n    secondaryCallToActionReturnUrl\n    secondaryBrandedAppStoreAsset {\n      ...ImageAsset\n      __typename\n    }\n    secondaryCallToActionUseAnalytics\n    secondaryOpenInNewTab\n    backgroundImagesNew {\n      small {\n        ...ImageAsset\n        __typename\n      }\n      medium {\n        ...ImageAsset\n        __typename\n      }\n      large {\n        ...ImageAsset\n        __typename\n      }\n      __typename\n    }\n    altText\n    showEmailSignupForm\n    __typename\n  }\n  __typename\n}\n\nfragment GalleryData on Gallery {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  galleryblocks {\n    id\n    contentHeight\n    primaryLogoSrcNew {\n      ...ImageAsset\n      __typename\n    }\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    backgroundImagesNew {\n      small {\n        ...ImageAsset\n        __typename\n      }\n      medium {\n        ...ImageAsset\n        __typename\n      }\n      large {\n        ...ImageAsset\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment MotionBannerData on MotionBanner {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  motionBannerBlocks {\n    id\n    title\n    isH1\n    tagline\n    bannerTheme\n    contentHorizontalPosition\n    primaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    animatedMedia\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    logoPosition\n    contentBackground\n    callToActionText\n    callToActionLink\n    callToActionUseAnalytics\n    secondaryCallToActionText\n    secondaryCallToActionLink\n    secondaryCallToActionUseAnalytics\n    backgroundImages {\n      small {\n        ...ImageAsset\n        __typename\n      }\n      medium {\n        ...ImageAsset\n        __typename\n      }\n      large {\n        ...ImageAsset\n        __typename\n      }\n      __typename\n    }\n    altText\n    __typename\n  }\n  __typename\n}\n\nfragment MotionSidekickData on MotionSidekick {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  motionSidekickBlocks {\n    id\n    title\n    isH1\n    tagline\n    bannerTheme\n    contentHorizontalPosition\n    primaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    animatedMedia\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    logoPosition\n    contentBackground\n    callToActionText\n    callToActionLink\n    callToActionUseAnalytics\n    backgroundImages {\n      small {\n        ...ImageAsset\n        __typename\n      }\n      medium {\n        ...ImageAsset\n        __typename\n      }\n      large {\n        ...ImageAsset\n        __typename\n      }\n      __typename\n    }\n    altText\n    __typename\n  }\n  __typename\n}\n\nfragment InPageNavData on InPageNav {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  inPageNavBlocks {\n    id\n    title\n    isH1\n    text\n    contrast\n    primaryLogoSrc\n    secondaryLogoSrc\n    animatedMedia\n    videoMedia {\n      url\n      id\n      subtitlesUrl\n      __typename\n    }\n    contentBackground\n    backgroundImages {\n      small\n      medium\n      large\n      __typename\n    }\n    callToActionText\n    callToActionLink\n    callToActionUseAnalytics\n    openInNewTab\n    secondaryCallToActionText\n    secondaryCallToActionLink\n    secondaryCallToActionUseAnalytics\n    secondaryOpenInNewTab\n    __typename\n  }\n  __typename\n}\n\nfragment TableData on TableSection {\n  rows {\n    isHeadingRow\n    cells\n    __typename\n  }\n  __typename\n}\n\nfragment RecommendationSectionData on RecommendationSection {\n  __typename\n  title\n  showTitle\n  recommendationType\n  themesSection {\n    ... on CardContentSection {\n      id\n      layout {\n        width\n        colors {\n          background\n          __typename\n        }\n        __typename\n      }\n      moduleTitle\n      showModuleTitle\n      blocks {\n        title\n        isH1\n        description\n        backgroundColor\n        textAlignment\n        imageSrc {\n          url\n          width\n          height\n          maxPixelDensity\n          format\n          __typename\n        }\n        primaryLogoSrc {\n          url\n          width\n          height\n          maxPixelDensity\n          format\n          __typename\n        }\n        secondaryLogoSrc {\n          url\n          width\n          height\n          maxPixelDensity\n          format\n          __typename\n        }\n        logoPosition\n        callToActionText\n        callToActionLink\n        callToActionUseAnalytics\n        callToActionOpenInNewTab\n        altText\n        contrast\n        videoMedia {\n          url\n          id\n          isLiveStream\n          subtitlesUrl\n          __typename\n        }\n        themeId\n        __typename\n      }\n      backgroundColor\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment SidekickBannerData on SidekickBanner {\n  __typename\n  id\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  sidekickBlocks {\n    title\n    isH1\n    text\n    textAlignment\n    contrast\n    backgroundColor\n    logoSrc {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    logoPosition\n    ctaTextPrimary: ctaText\n    ctaLinkPrimary: ctaLink\n    ctaOpenInNewTab\n    ctaUseAnalyticsPrimary: ctaUseAnalytics\n    brandedAppStoreAsset {\n      ...ImageAsset\n      __typename\n    }\n    ctaTextSecondary\n    ctaLinkSecondary\n    ctaOpenInNewTabSecondary\n    ctaUseAnalyticsSecondary\n    secondaryBrandedAppStoreAsset {\n      ...ImageAsset\n      __typename\n    }\n    contentHeight\n    bgImages {\n      large\n      __typename\n    }\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    altText\n    __typename\n  }\n}\n\nfragment ProductCarousel_UniqueFields on ProductCarouselSection {\n  __typename\n  productCarouselTitle: title\n  showTitle\n  showAddToBag\n  seeAllLink\n}\n\nfragment TextBlockData on TextBlock {\n  textBlocks {\n    title\n    isH1\n    text\n    textAlignment\n    contrast\n    backgroundColor\n    callToActionLink\n    callToActionText\n    callToActionUseAnalytics\n    openInNewTab\n    secondaryCallToActionLink\n    secondaryCallToActionText\n    secondaryCallToActionUseAnalytics\n    secondaryOpenInNewTab\n    __typename\n  }\n  __typename\n}\n\nfragment TextBlockSEOData on TextBlockSEO {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  textBlocks {\n    title\n    text\n    __typename\n  }\n  __typename\n}\n\nfragment CrowdTwistWidgetSection on CrowdTwistWidgetSection {\n  __typename\n  id\n  heading\n  activityId\n  rewardId\n  defaultOpen\n}\n\nfragment CrowdTwistToggleWidgetSection on CrowdTwistToggleWidgetSection {\n  __typename\n  defaultOpen\n  firstStepDescription\n  firstStepHeading\n  id\n  secondStepHeading\n  heading\n  radioButtons {\n    activityId\n    buttonLabel\n    rewardId\n    __typename\n  }\n  isVipBannerVisible\n}\n\nfragment CrowdTwistCodeRedemptionBanner on CrowdTwistCodeRedemptionBanner {\n  __typename\n  heading\n  description\n  buttonText\n  inputLabel\n  campaignId\n  groupCampaignId\n  imageUrl\n}\n\nfragment CodedSection on CodedSection {\n  __typename\n  id\n  componentName\n  properties {\n    key\n    value\n    __typename\n  }\n  text {\n    key\n    value\n    __typename\n  }\n  media {\n    key\n    values {\n      id\n      contentType\n      fileSize\n      filename\n      url\n      title\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment GridSectionData on GridSection {\n  layout {\n    colors {\n      background\n      __typename\n    }\n    __typename\n  }\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  items {\n    id\n    image\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    href\n    text\n    textContrast\n    __typename\n  }\n  __typename\n}\n\nfragment AudioSectionData on AudioSection {\n  tracks {\n    trackArt {\n      ...ImageAsset\n      __typename\n    }\n    src\n    title\n    description\n    __typename\n  }\n  backgroundColor\n  textContrast\n  backgroundImage {\n    mobile {\n      ...ImageAsset\n      __typename\n    }\n    desktop {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  seriesTitle\n  seriesThumbnail {\n    ...ImageAsset\n    __typename\n  }\n  __typename\n}\n\nfragment StickyCTAData on StickyCTASection {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  item {\n    backgroundColor\n    ctaBackgroundImage\n    ctaPosition\n    href\n    openInNewTab\n    accountAction\n    returnUrl\n    text\n    textAlign\n    textContrast\n    effect\n    delay\n    __typename\n  }\n  __typename\n}\n\nfragment MotionSidekick1x1Data on MotionSidekick1x1 {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  motionSidekickBlocks {\n    id\n    title\n    description\n    textContrast\n    contentHorizontalPosition\n    primaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    inlineVideo {\n      ...VideoAssetFragment\n      __typename\n    }\n    fullVideo {\n      ...VideoAssetFragment\n      __typename\n    }\n    logoHorizontalPosition\n    backgroundColor\n    primaryCallToActionText\n    primaryCallToActionLink\n    primaryCallToActionUseAnalytics\n    secondaryCallToActionText\n    secondaryCallToActionLink\n    secondaryCallToActionUseAnalytics\n    __typename\n  }\n  __typename\n}\n\nfragment ImageTransitionSliderData on ImageTransitionSlider {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  imageTransitionSliderBlocks {\n    id\n    title\n    description\n    backgroundColor\n    contrast\n    ctas {\n      link\n      text\n      useAnalytics\n      __typename\n    }\n    contentHorizontalPosition\n    firstImage {\n      ...ImageAsset\n      __typename\n    }\n    secondImage {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment ImageXrayViewerData on ImageXrayViewer {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  imageXrayViewerBlocks {\n    id\n    title\n    description\n    backgroundColor\n    contrast\n    ctas {\n      link\n      text\n      useAnalytics\n      __typename\n    }\n    contentHorizontalPosition\n    firstImage {\n      ...ImageAsset\n      __typename\n    }\n    secondImage {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment PollsSectionData on PollsSection {\n  id\n  question\n  backgroundColor\n  answerFillColor\n  answerBorderColor\n  answers {\n    answer\n    id\n    __typename\n  }\n  image {\n    ...ImageAsset\n    __typename\n  }\n  imageAlignment\n  pollResults {\n    answers {\n      answerId\n      count\n      __typename\n    }\n    totalVotes\n    __typename\n  }\n  showPollResults\n  submissionConfirmationTitle\n  submissionConfirmationContent\n  __typename\n}\n\nfragment ArtNavigationData on ArtNavigation {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  artNavigationBlocks {\n    id\n    title\n    cardTitle\n    darkMode\n    callToActionLink\n    backgroundImage {\n      ...ImageAsset\n      __typename\n    }\n    logoImage {\n      ...ImageAsset\n      __typename\n    }\n    textImage {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment MotionBanner16x9Data on MotionBanner16x9 {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  motionBannerBlocks {\n    id\n    title\n    isH1\n    tagline\n    contentHorizontalPosition\n    primaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    animatedMedia\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    logoPosition\n    contentBackground\n    callToActionText\n    callToActionLink\n    callToActionUseAnalytics\n    secondaryCallToActionText\n    secondaryCallToActionLink\n    secondaryCallToActionUseAnalytics\n    altText\n    __typename\n  }\n  __typename\n}\n\nfragment QuickLinksAdvancedData on QuickLinkAdvancedSection {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  linkCount\n  backgroundColor\n  items {\n    title\n    link\n    openInNewTab\n    contrast\n    imageSrc {\n      small {\n        ...ImageAsset\n        __typename\n      }\n      medium {\n        ...ImageAsset\n        __typename\n      }\n      __typename\n    }\n    textAlignment\n    textAlignmentVertical\n    __typename\n  }\n  __typename\n}\n\nfragment ArticleSectionData on ArticleSection {\n  id\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  articleBlocks {\n    id\n    contentTitle\n    setAsH1\n    richText\n    width\n    product {\n      ...Product_ProductItem\n      __typename\n    }\n    productAlignment\n    backgroundColor\n    contentAlignment\n    callToActionText\n    callToActionType\n    callToActionLink\n    callToActionUseAnalytics\n    openInNewTab\n    image {\n      ...ImageAsset\n      __typename\n    }\n    caption\n    captionDarkMode\n    __typename\n  }\n  __typename\n}\n\nfragment RelatedArticleSectionData on RelatedArticleSection {\n  id\n  title\n  articles {\n    id\n    title\n    description\n    url\n    image {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  backgroundColor\n  showCta\n  target {\n    text\n    href\n    __typename\n  }\n  __typename\n}\n\nfragment FeatureExplorerSectionData on FeatureExplorerSection {\n  id\n  title\n  showHeader\n  showHeaderLabel\n  backgroundGradientColors {\n    backgroundLightColor\n    backgroundDarkColor\n    __typename\n  }\n  overlayBackgroundColor\n  overlayTextColor\n  accentColor\n  logo {\n    image\n    altText\n    __typename\n  }\n  secondaryLogo {\n    image\n    altText\n    __typename\n  }\n  features {\n    title\n    text\n    scene\n    position {\n      x\n      y\n      __typename\n    }\n    video\n    image\n    __typename\n  }\n  frames\n  __typename\n}\n\nfragment IdeaGeneratorSectionData on IdeaGeneratorSection {\n  id\n  title\n  previewContent {\n    title\n    text\n    callToActionText\n    __typename\n  }\n  mainContent {\n    startText\n    retryText\n    ideaLimit\n    unlockThreshold\n    endText\n    callToAction {\n      text\n      link\n      openInNewWindow\n      __typename\n    }\n    __typename\n  }\n  problems {\n    text\n    image\n    altText\n    tags\n    __typename\n  }\n  multipliers {\n    text\n    image\n    altText\n    tags\n    __typename\n  }\n  validProblems {\n    text\n    image\n    altText\n    tags\n    __typename\n  }\n  __typename\n}\n\nfragment TabbedContentExplorerData on TabbedContentExplorerSection {\n  __typename\n  id\n  blocks {\n    title\n    backgroundColor\n    accentColor\n    target {\n      href\n      text\n      openInNewTab\n      __typename\n    }\n    images {\n      alt\n      desktop {\n        ...ImageAsset\n        __typename\n      }\n      mobile {\n        ...ImageAsset\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment CustomProductCarousel_UniqueFields on CustomProductCarouselSection {\n  __typename\n  productCarouselTitle: title\n  showTitle\n  showAddToBag\n  seeAllLink\n  backgroundColor\n}\n\nfragment CustomProductCarousel_ItemFields on CustomProductCarouselItem {\n  product {\n    ...Product_ProductItem\n    __typename\n  }\n  imageOverride {\n    ...ImageAsset\n    __typename\n  }\n  imageBackgroundColor\n  contentBackgroundColor\n  ctaButtonColor\n  __typename\n}\n\nfragment Countdown on CountdownBannerChild {\n  title\n  text\n  contrast\n  backgroundColor\n  callToActionLink\n  callToActionText\n  openInNewTab\n  countdownDate\n  countdownDateFormat\n  __typename\n}\n\nfragment CountdownBannerData on CountdownBanner {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  countdownBannerBlocks {\n    ...Countdown\n    __typename\n  }\n  __typename\n}\n\nfragment CardContentRTWData on CardContentRTWSection {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  moduleTitle\n  showModuleTitle\n  backgroundColor\n  preferCarousel\n  hasShadow\n  blocks {\n    title\n    description\n    backgroundColor\n    textAlignment\n    imageSrc {\n      ...ImageAsset\n      __typename\n    }\n    altText\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment ExpandedCardContentData on ExpandedCardContentSection {\n  isStaggered\n  darkMode\n  contentOpacity\n  contentBackgroundColor\n  blocks {\n    id\n    title\n    text\n    darkMode\n    contentAlignment\n    desktopBackgroundImage {\n      ...ImageAsset\n      __typename\n    }\n    mobileBackgroundImage {\n      ...ImageAsset\n      __typename\n    }\n    target {\n      href\n      text\n      openInNewTab\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment ArticleTextData on ArticleTextSection {\n  id\n  title\n  richText\n  textAlignment\n  __typename\n}\n\nfragment ArticleImageSectionData on ArticleImageSection {\n  title\n  image {\n    ...ImageAsset\n    __typename\n  }\n  altText\n  caption\n  captionBackground\n  __typename\n}\n\nfragment ExpandedProductLeafData on ExpandedProductLeafSection {\n  id\n  productCode\n  __typename\n}\n\nfragment Dots3DSectionData on Dots3DSection {\n  id\n  isSingleSKU\n  tiles {\n    id\n    color\n    shape\n    sticker\n    sets\n    ip\n    rotation\n    alpha\n    __typename\n  }\n  tiles3D\n  models {\n    setId\n    ip\n    label\n    pdpLink\n    glb\n    image\n    zoom {\n      min\n      max\n      start\n      __typename\n    }\n    cameraRotation {\n      minHorizontal\n      maxHorizontal\n      minVertical\n      maxVertical\n      __typename\n    }\n    rotation\n    bgColor\n    bgContrast\n    backLight\n    __typename\n  }\n  home {\n    title\n    heading\n    body\n    selectButtonText\n    backgroundImageMobile\n    backgroundImageTablet\n    backgroundImageDesktop\n    __typename\n  }\n  decorate {\n    title\n    tileDrawer {\n      title\n      filterText\n      colorPickerText\n      __typename\n    }\n    helpGuide {\n      title\n      closeButtonText\n      helpItems {\n        title\n        text\n        image\n        __typename\n      }\n      __typename\n    }\n    helpText\n    clearTilesText\n    __typename\n  }\n  download {\n    title\n    logo\n    discoverText\n    discoverImage\n    discoverButtonText\n    discoverButtonLink\n    downloadButtonText\n    ctaButtonText\n    canvasLabel\n    backgroundImageMobile\n    backgroundImageTablet\n    backgroundImageDesktop\n    hashtag\n    __typename\n  }\n  popups {\n    name\n    title\n    text\n    continueText\n    cancelText\n    __typename\n  }\n  logos {\n    ip\n    logo\n    __typename\n  }\n  modal {\n    ariaLabel\n    closeButtonAriaLabel\n    __typename\n  }\n  __typename\n}\n\nfragment NinetiethAnniversaryExperienceData on NinetiethAnniversaryExperienceSection {\n  start {\n    heading\n    subHeading\n    text\n    ctaText\n    backgroundImage\n    __typename\n  }\n  charge {\n    instructionText\n    skipText\n    ctaText\n    chargeMask\n    __typename\n  }\n  end {\n    downloadButtonText\n    restartButtonText\n    straplineText\n    hashtagText\n    endScreenBackgroundTopLeft\n    endScreenBackgroundBottomRight\n    __typename\n  }\n  bricks {\n    image\n    name\n    quote\n    released\n    dimensions\n    count\n    weight\n    __typename\n  }\n  quiz {\n    instructionText\n    questionCount\n    questions {\n      text\n      image\n      swipeRightText\n      swipeLeftText\n      colorPalette {\n        background\n        question\n        card\n        topLeftImage\n        bottomRightImage\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  brickCard {\n    countLabel\n    backgroundImage\n    colors\n    dimensionsLabel\n    heading\n    releasedLabel\n    weightLabel\n    __typename\n  }\n  __typename\n}\n\nfragment ArticleGroupSectionData on ArticleGroupSection {\n  articleGroupBlocks {\n    ... on ArticleGroupImageBlock {\n      id\n      __typename\n      layout {\n        width\n        colors {\n          background\n          __typename\n        }\n        __typename\n      }\n      image {\n        ...ImageAsset\n        __typename\n      }\n      altText\n      caption\n      captionBackground\n    }\n    ... on ArticleGroupTextBlock {\n      id\n      __typename\n      layout {\n        width\n        colors {\n          background\n          __typename\n        }\n        __typename\n      }\n      textAlignment\n      richText\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment MotionBannerSectionData on MotionBannerSection {\n  id\n  title\n  isH1\n  tagline\n  bannerTheme\n  contentHorizontalPosition\n  contentVerticalPosition\n  aspectRatio\n  backgroundVideoMobile\n  backgroundVideoTablet\n  backgroundVideoDesktop\n  modalVideo {\n    ...VideoAssetFragment\n    __typename\n  }\n  backgroundImages {\n    small {\n      ...ImageAsset\n      __typename\n    }\n    medium {\n      ...ImageAsset\n      __typename\n    }\n    large {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  altText\n  primaryLogoSrc {\n    ...ImageAsset\n    __typename\n  }\n  secondaryLogoSrc {\n    ...ImageAsset\n    __typename\n  }\n  primaryCallToAction {\n    href\n    text\n    openInNewTab\n    accountAction\n    returnUrl\n    useAnalytics\n    __typename\n  }\n  secondaryCallToAction {\n    href\n    text\n    openInNewTab\n    accountAction\n    returnUrl\n    useAnalytics\n    __typename\n  }\n  logoPosition\n  __typename\n}\n\nfragment ColorPaletteColor on ColorPaletteColor {\n  designToken\n  contrastingTextColor\n  __typename\n}\n\nfragment AdvancedProductHeroBannerSectionData on AdvancedProductHeroBannerSection {\n  id\n  title\n  productCode\n  productDescriptionText\n  isAtTopOfPage\n  infoTagText\n  target {\n    href\n    text\n    __typename\n  }\n  colorPalette {\n    primary {\n      ...ColorPaletteColor\n      __typename\n    }\n    secondary {\n      ...ColorPaletteColor\n      __typename\n    }\n    tertiary {\n      ...ColorPaletteColor\n      __typename\n    }\n    quaternary {\n      ...ColorPaletteColor\n      __typename\n    }\n    __typename\n  }\n  productImage {\n    desktop\n    mobile\n    alt\n    __typename\n  }\n  infoPanel {\n    text\n    alt\n    logo\n    secondaryAlt\n    secondarylogo\n    __typename\n  }\n  localizations\n  __typename\n}\n\nfragment PlayTypeDetectorSectionData on PlayTypeDetectorSection {\n  id\n  colors {\n    answer1\n    answer2\n    cardTheme\n    cta\n    __typename\n  }\n  startStep {\n    heading\n    text\n    ctaText\n    background {\n      desktopImage\n      desktopTheme\n      mobileImage\n      mobileTheme\n      __typename\n    }\n    __typename\n  }\n  questionsStep {\n    background {\n      desktopImage\n      desktopTheme\n      mobileImage\n      mobileTheme\n      __typename\n    }\n    slider {\n      helpText\n      draggerImage\n      answer1TargetImage\n      answer1ConfirmationImage\n      answer2TargetImage\n      answer2ConfirmationImage\n      __typename\n    }\n    questions {\n      id\n      text\n      answers {\n        text\n        image\n        targetPage\n        targetQuestion\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  referralStep {\n    image\n    heading\n    text\n    __typename\n  }\n  __typename\n}\n\nfragment SocialShareSectionData on SocialShareSection {\n  id\n  title\n  sharingTitle\n  sharingBodyText\n  socialSharePlatforms\n  hashtags\n  displaySocialIcons\n  layout {\n    width\n    __typename\n  }\n  __typename\n}\n\nfragment EcosystemJourneyStarterData on EcosystemJourneyStarterSection {\n  id\n  title\n  isH1\n  icmp_tag\n  themes {\n    colors {\n      background\n      contentTitle\n      contentBackground\n      contentBodyMobile\n      contentBodyDesktop\n      navigationHighlight\n      accentLeft\n      accentRight\n      cta\n      navigation\n      __typename\n    }\n    navigation {\n      name\n      logo\n      thumbnail\n      __typename\n    }\n    content {\n      image\n      altText\n      title\n      body\n      ageSuitability\n      primaryCTALabel\n      primaryCTALink\n      primaryCTAOpenInNewWindow\n      secondaryCTALabel\n      secondaryCTALink\n      secondaryCTAOpenInNewWindow\n      __typename\n    }\n    productCarousel {\n      label\n      products {\n        productCode\n        image\n        openInNewWindow\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment ResultsBannerSectionData on ResultsBannerSection {\n  id\n  title\n  resultsBannerBackgroundColor: backgroundColor\n  fontColor\n  mobileImageLeft\n  desktopImageLeft\n  desktopImageRight\n  desktopButtonText\n  noResults {\n    noResultsText\n    ctaText\n    secondaryCta {\n      text\n      url\n      __typename\n    }\n    easterEgg {\n      heading\n      subHeading\n      easterEggImage\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment CharacterExplorerSectionData on CharacterExplorerSection {\n  id\n  title\n  backButtonLabel\n  productSubtitle\n  removeIntroScreenCtas\n  characters {\n    intro {\n      image\n      tagline\n      characterCTALabel\n      title\n      __typename\n    }\n    colors {\n      character\n      characterLabel\n      bio\n      bioLabel\n      background\n      textHighlight\n      highlightLabelDesktop\n      highlightLabelMobile\n      productBackground\n      productLabel\n      __typename\n    }\n    characterProduct {\n      title\n      overrideImage\n      code\n      __typename\n    }\n    content {\n      body\n      header\n      bioImage\n      mobileNavigationLabels\n      passions {\n        icon\n        value\n        __typename\n      }\n      __typename\n    }\n    nonShoppableContent {\n      image\n      text\n      mobileNavigationLabelRight\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SubmissionFormBannerSectionData on SubmissionFormBannerSection {\n  id\n  title\n  layout {\n    width\n    colors {\n      background\n      __typename\n    }\n    __typename\n  }\n  bannerContent {\n    title\n    body\n    backgroundImageSmall\n    backgroundImageMedium\n    backgroundImageLarge\n    backgroundColorMobile\n    fontColor\n    video\n    primaryCTALabel\n    secondaryCTALabel\n    __typename\n  }\n  modalContent {\n    formId\n    closeLabel\n    title\n    description\n    fields {\n      fieldId\n      type\n      label\n      placeholderText\n      errorText\n      options {\n        value\n        label\n        __typename\n      }\n      __typename\n    }\n    fileUploadParams {\n      maxSizeInMb\n      allowedFileExtensions\n      __typename\n    }\n    termsAndConditionsLabel\n    termsAndConditions\n    termsAndConditionsFile\n    termsAndConditionsDownloadLabel\n    consentLabel\n    submitButtonLabel\n    __typename\n  }\n  successMessageContent {\n    title\n    body\n    additionalContent\n    ctaLabel\n    ctaIcon\n    ctaLink\n    __typename\n  }\n  translations {\n    key\n    value\n    __typename\n  }\n  __typename\n}\n\nfragment RebuildTheWorld2023Data on RebuildTheWorld2023 {\n  content {\n    common {\n      backButtonText\n      heroImageAltText\n      flareImage\n      magnifyingGlassImage\n      backgroundColor\n      __typename\n    }\n    bannerStep {\n      title\n      body\n      ctaText\n      foregroundImageMobile\n      foregroundImageDesktop\n      __typename\n    }\n    playStep {\n      ctaText\n      nextButtonText\n      previousButtonText\n      instructionalText\n      unlockText\n      errorText\n      backgroundImageMobile\n      backgroundImageDesktop\n      incorrectGuessImage\n      incorrectGuessAltText\n      codeGroups {\n        colorName\n        title\n        body\n        defaultCode {\n          image\n          altText\n          __typename\n        }\n        correctCode {\n          image\n          altText\n          __typename\n        }\n        incorrectCodes {\n          image\n          altText\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    heroRevealStep {\n      loadingText\n      headingText\n      preRevealText\n      ctaText\n      powers {\n        colorName\n        color\n        accentColor\n        backgroundImageMobile\n        backgroundImageDesktop\n        __typename\n      }\n      __typename\n    }\n    customiseStep {\n      closeButtonText\n      personaliseButtonText\n      finishButtonText\n      traySections {\n        head {\n          label\n          active\n          inactive\n          options\n          __typename\n        }\n        hair {\n          label\n          active\n          inactive\n          options\n          __typename\n        }\n        beard {\n          label\n          active\n          inactive\n          options\n          __typename\n        }\n        torso {\n          label\n          active\n          inactive\n          options\n          __typename\n        }\n        legs {\n          label\n          active\n          inactive\n          options\n          __typename\n        }\n        crutches {\n          label\n          active\n          inactive\n          options\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    confirmStep {\n      flipButtonText\n      rearCardTitle\n      rearCardBodyAdults\n      rearCardBodyKids\n      rearCardCTAText\n      rearCardCTALink\n      downloadCTAText\n      shareCTAText\n      restartCTAText\n      hashtagText\n      rearCardImage\n      frontCardImages {\n        colorName\n        image\n        __typename\n      }\n      __typename\n    }\n    minifigLayers {\n      head {\n        color\n        colorLabel\n        image\n        __typename\n      }\n      hair {\n        color\n        colorLabel\n        images\n        __typename\n      }\n      beard {\n        color\n        colorLabel\n        images\n        __typename\n      }\n      face\n      torso {\n        colorName\n        images\n        __typename\n      }\n      legs {\n        colorName\n        images\n        __typename\n      }\n      crutches\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment PromotionSectionData on PromotionSection {\n  id\n  isExpanded\n  backgroundColorPalette: backgroundColor {\n    ...ColorPaletteColor\n    __typename\n  }\n  accentTextColorPalette: accentTextColor {\n    ...ColorPaletteColor\n    __typename\n  }\n  __typename\n}\n\nfragment ProductDetails_Product on Product {\n  id\n  productCode\n  name\n  slug\n  metaTitle\n  metaDescription\n  noIndexTag\n  nextStockDropDate\n  ... on SingleVariantProduct {\n    variant {\n      ...Variant_ProductDetails\n      __typename\n    }\n    __typename\n  }\n  ... on MultiVariantProduct {\n    vipPointsRange\n    variants {\n      ...Variant_ProductDetails\n      __typename\n    }\n    __typename\n  }\n  ... on ReadOnlyProduct {\n    readOnlyVariant {\n      attributes {\n        pieceCount\n        buildHeight\n        buildWidth\n        buildDepth\n        minifigureCount\n        ageRange\n        hideBuildingInstructions\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  socialImage: primaryImage(size: HIRES)\n  __typename\n}\n\nfragment Variant_ProductDetails on ProductVariant {\n  vipPoints\n  attributes {\n    availabilityStatus\n    availabilityText\n    vipAvailabilityStatus\n    vipAvailabilityText\n    canAddToBag\n    vipCanAddToBag\n    ageRange\n    pieceCount\n    buildHeight\n    buildWidth\n    buildDepth\n    minifigureCount\n    headlineText\n    isNew\n    onSale\n    rating\n    hideBuildingInstructions\n    vipEarlyAccess\n    vipEarlyAccessStartDate\n    vipEarlyAccessDateText\n    __typename\n  }\n  __typename\n}\n\nfragment ProductFeatures_Product on Product {\n  id\n  productCode\n  featuresPrimaryImage: primaryImage(size: HIRES)\n  productMedia {\n    items {\n      id\n      __typename\n    }\n    __typename\n  }\n  name\n  description\n  secondaryImage(size: THUMBNAIL)\n  featuresText\n  ... on SingleVariantProduct {\n    variant {\n      ...Variant_ProductFeatures\n      __typename\n    }\n    __typename\n  }\n  ... on MultiVariantProduct {\n    variants {\n      ...Variant_ProductFeatures\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment Variant_ProductFeatures on ProductVariant {\n  attributes {\n    canAddToBag\n    bulletText\n    __typename\n  }\n  images {\n    url\n    __typename\n  }\n  __typename\n}\n\nfragment ProductUgc_Product on Product {\n  id\n  ... on SingleVariantProduct {\n    ugcBlock {\n      text\n      ugcType\n      ugcKey\n      __typename\n    }\n    __typename\n  }\n  ... on MultiVariantProduct {\n    ugcBlock {\n      text\n      ugcType\n      ugcKey\n      __typename\n    }\n    __typename\n  }\n  ... on ReadOnlyProduct {\n    ugcBlock {\n      text\n      ugcType\n      ugcKey\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment ProductOverview_Product on Product {\n  id\n  name\n  productCode\n  metaTitle\n  productCategories {\n    name\n    url\n    key\n    __typename\n  }\n  brandCategory {\n    url\n    name\n    logoUrl\n    __typename\n  }\n  ... on ReadOnlyProduct {\n    color\n    readOnlyVariant {\n      id\n      sku\n      attributes {\n        ...ProductAttributes_SafetyWarning\n        featuredFlags {\n          key\n          label\n          __typename\n        }\n        __typename\n      }\n      thirdPartyRetailers {\n        ...ProductOverview_ThirdPartyRetailer\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  ... on SingleVariantProduct {\n    color\n    variant {\n      ...Variant_ProductOverview\n      __typename\n    }\n    __typename\n  }\n  ... on MultiVariantProduct {\n    multiVariantType\n    color\n    priceRange {\n      formattedPriceRange\n      formattedListPriceRange\n      __typename\n    }\n    variants {\n      ...Variant_ProductOverview\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment Variant_ProductOverview on ProductVariant {\n  id\n  sku\n  price {\n    centAmount\n    formattedAmount\n    __typename\n  }\n  listPrice {\n    centAmount\n    formattedAmount\n    formattedValue\n    __typename\n  }\n  salePercentage\n  attributes {\n    canAddToBag\n    vipCanAddToBag\n    canAddToWishlist\n    availabilityStatus\n    availabilityText\n    vipAvailabilityStatus\n    vipAvailabilityText\n    onSale\n    rating\n    maxOrderQuantity\n    skuSelectorValue\n    showStoreInventory\n    showReviews\n    bisNotificationState\n    ...ProductAttributes_Flags\n    ...ProductAttributes_SafetyWarning\n    __typename\n  }\n  promo {\n    ...TargetedPromotionSection\n    __typename\n  }\n  promos {\n    ...TargetedPromotionSection\n    __typename\n  }\n  __typename\n}\n\nfragment TargetedPromotionSection on PromotionTargeter {\n  section {\n    text\n    countdownDate\n    callToActionText\n    callToActionLink\n    tooltipText\n    imageSrc {\n      ...ImageAsset\n      __typename\n    }\n    promotionType\n    __typename\n  }\n  fetchOnClient\n  testId\n  variantId\n  inExperimentAudience\n  __typename\n}\n\nfragment ProductOverview_ThirdPartyRetailer on ThirdPartyRetailer {\n  name\n  logoImage {\n    ...ImageAsset\n    __typename\n  }\n  url\n  __typename\n}\n\nfragment ProductAttributes_SafetyWarning on ProductAttributes {\n  safetyWarning {\n    key\n    label\n    showSafetyImage\n    imageKey\n    __typename\n  }\n  __typename\n}\n\nfragment ProductMediaViewer_Media on Product {\n  ... on SingleVariantProduct {\n    variant {\n      ...Attributes\n      __typename\n    }\n    __typename\n  }\n  ... on MultiVariantProduct {\n    variants {\n      ...Attributes\n      __typename\n    }\n    __typename\n  }\n  mediaViewerPrimaryImage: primaryImage(size: HIRES)\n  productCode\n  productMedia {\n    items {\n      ...ProductMediaItem\n      __typename\n    }\n    __typename\n  }\n  experimentMedia {\n    items {\n      ...ProductMediaItem\n      __typename\n    }\n    __typename\n  }\n  productMediaAssets {\n    ...ProductMediaAssetItem\n    __typename\n  }\n  experimentMediaAssets {\n    ...ProductMediaAssetItem\n    __typename\n  }\n  __typename\n}\n\nfragment Attributes on ProductVariant {\n  attributes {\n    rating\n    ...ProductAttributes_Flags\n    __typename\n  }\n  __typename\n}\n\nfragment ProductMediaItem on ProductMedia {\n  id\n  ... on ProductImage {\n    ...ProductZoomableImage\n    __typename\n  }\n  ... on ProductVideo {\n    ...VideoMedia\n    __typename\n  }\n  __typename\n}\n\nfragment VideoMedia on ProductVideo {\n  video {\n    url\n    thumbnailUrl\n    __typename\n  }\n  __typename\n}\n\nfragment ProductZoomableImage on ProductImage {\n  baseImgUrl\n  sizes {\n    desktop {\n      url\n      thumbnailUrl\n      highResUrl\n      fullscreenUrl\n      __typename\n    }\n    mobile {\n      url\n      thumbnailUrl\n      highResUrl\n      fullscreenUrl\n      __typename\n    }\n    tablet {\n      url\n      thumbnailUrl\n      highResUrl\n      fullscreenUrl\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment ProductMediaAssetItem on ProductMediaAsset {\n  ... on ProductAssetImage {\n    id\n    url\n    defaultDimensions {\n      ...DimensionFragment\n      __typename\n    }\n    fullscreenDimensions {\n      ...DimensionFragment\n      __typename\n    }\n    highResDimensions {\n      ...DimensionFragment\n      __typename\n    }\n    thumbnailDimensions {\n      ...DimensionFragment\n      __typename\n    }\n    __typename\n  }\n  ... on ProductVideo {\n    id\n    video {\n      url\n      thumbnailUrl\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment DimensionFragment on ProductAssetImageDimensions {\n  width {\n    ...DeviceSizeFragment\n    __typename\n  }\n  height {\n    ...DeviceSizeFragment\n    __typename\n  }\n  __typename\n}\n\nfragment DeviceSizeFragment on DevicesSize {\n  default\n  desktop\n  tablet\n  mobile\n  __typename\n}",
                },
                headers={"x-locale": "it-IT"},
                callback=self.parse,
            )

    def parse(self, response):
        result = response.json()["data"]["product"]
        yield Item(
            site="Lego",
            id=result["id"],
            url=f"https://www.lego.com/it-it/product/{result['slug']}",
            image=result["baseImgUrl"],
            title=result["name"],
            currency="€",
            price=result["variant"]["price"]["formattedValue"],
            condition=None,
            in_stock=result["variant"]["attributes"]["canAddToBag"],
        )
